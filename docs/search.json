[{"path":"index.html","id":"preface","chapter":"Preface","heading":"Preface","text":"Objective: least cover high value insights R vs SAS use cases examples -depth exposition (note: meant exhaustive)","code":""},{"path":"introduction.html","id":"introduction","chapter":"1 Introduction","heading":"1 Introduction","text":"Several discrepancies discovered statistical analysis results different programming languages, even fully qualified statistical computing environments. Subtle differences exist fundamental approaches implemented language, yielding differences results correct right. fact differences exist causes unease behalf sponsor companies submitting regulatory agency, uncertain agency view differences problematic. Statistical Software Clarifying Statement, US Food Drug Administration (FDA) states “FDA require use specific software statistical analyses” “computer software used data management statistical analysis reliable.” Observing differences across languages can reduce analyst’s confidence reliability , understanding source discrepancies, one can reinstate confidence reliability.white paper aims empower analysts make informed choices implementation statistical analyses multiple languages yield different results. objective prescribe choice , rather provide guidance types questions analyst ask order identify fundamental sources discrepant results. discrepancies may exist variety different reasons, paper explore provide examples.context, risk interpreting numerical differences analysis results due solely differences programming language can mitigated, instilling confidence sponsor company agency review period.WIP Note: don’t like sentence need think ’d actually want change .","code":""},{"path":"introduction.html","id":"motivation","chapter":"1 Introduction","heading":"1.1 Motivation","text":"","code":""},{"path":"introduction.html","id":"background","chapter":"1 Introduction","heading":"1.2 Background","text":"clinical data analytics evolves within pharmaceutical industry, large noteworthy contingent people organizations explored use various computational technologies effort reimagine tell story data collected course clinical trial. technologies, whether available commercially open source, offer new potential ability sponsor company discover new medicines demonstrate can safely effectively administered patients given indication. see applications machine learning artificial intelligence built exploratory analyses well automation conventional reporting pipelines, expanded offerings commercial products tools developed available open source. witnessing desired transformation deliver clinical insights flat data files rows/columns compiled PDF reports dynamic visualization platforms facilitate reviewer explore trial database three-dimensional way. , notably, tools industries commonly used ‘new’ ways data engineering, data analytics, data reporting often built programming languages historically used within pharmaceutical industry, experiencing dramatic shift away dependence small set commercially available solutions toward embracing many languages build use best-fit tools extract knowledge clinical data.WIP Note:value discussing changing demographic analysts industry – R vs SAS grad experience, exampleWant trim back make concise. like storytelling piece, think also focus access new/advanced statistical methods rapid advancements open-source data analysis tools past 10 years .last piece brought light element data analytics previously overlooked due dependence single solution one programming language. Within clinical reporting pipeline (transforming patient level clinical trial data collection submission), industry historically relied comparing results independently generated second set results primary form quality control (QC). early years, comparisons made paper thoroughly verified human number table matched number independently derived second programmer. technology progressed, electronic comparisons output data presented table reduced risk human error validator missed discrepancy. theory two people put inputs two independently developed processes (code) achieve outcome, outcome must right. ’s perfect system can produce false positives, efficiencies gained quality improved.However, recently, QC process nearly always implemented programming language used generation results (‘production’) independent QC. shift industry explore languages now raised questions “numbers don’t match? correct?”example, one take use case compare rounding rules SAS® R, now becoming well understood default rounding rule (implemented respective language’s round() function) different, number rounded equidistant two possible results. round() function SAS round number ‘away zero’, meaning 12.5 rounds integer 13. round() function Base R round number ‘even’, meaning 12.5 rounds integer 12. SAS also rounde() function rounds even janitor package R contains function rounds away zero. use case, SAS produces correct result round() function, based documentation, R. right based say , produce different results.WIP Note: Can make table illustrate ?want see rest paper pans think move use cases discussion. Referencing rounding think ’s important also note round even based IEC 60559 standardNow, analyst choice make R SAS toolbox – round result? answer question, analyst needs understand rationale behind round--even rule round-away--zero rule, even rounding rules may exist. knowledge, ‘round’ question never asked respect clinical trial reporting difference R SAS default rounding discovered. ‘correct’ answer analyst determine justify. likely depends things understanding impact resulting data story safety efficacy investigational product.analyst care? matter? One answer want tell accurate story data. However, perhaps importantly highly regulated pharmaceutical industry, third-party reviewer assessing integrity data. reviewer attempts reproduce results chooses different language, analyst needs able explain results may differ, else integrity entire package may questioned. fully understanding implications choosing statistical modeling implementation Language vs Language B, analyst can communicate rationale choice, based sound statistical reasoning, instill confidence regulatory body reviewing submitted data.noted follows, assumed statistical packages routines perform manner consistent documentation. question hand whether procedures accurate reliable, rather, ways similar implementations across languages differ. Hence, concerned another major area discussion within industry – -called validation packages software.","code":""},{"path":"introduction.html","id":"other-readings","chapter":"1 Introduction","heading":"1.3 Other Readings","text":"Perhaps cite TransCelerate MoA projectPerhaps cite working groups published conference proceedings","code":""},{"path":"available-resources.html","id":"available-resources","chapter":"2 Available Resources","heading":"2 Available Resources","text":"","code":""},{"path":"available-resources.html","id":"contributing-via-github","chapter":"2 Available Resources","heading":"2.1 Contributing via GitHub","text":"Git localized version control system allows users make changes files revert working state whenever needed. GitHub service allows sharing git repositories, number people can make contributions project, maintaining separate stable development branches project files. addition storing git repositories, GitHub useful displaying project documentation, tracking issues feature requests, making comments, taking part discussions, along offering tools project management automation.GitHub integrates seamlessly RStudio. create new project within RStudio, given option use git track repository, connect local repository online repository GitHub. goes ways – start project RStudio later link new repository GitHub, can make clone existing repository GitHub use local RStudio. R built foundation open-source principles, GitHub become central location many open-source R packages, including many RStudio’s packages like Tidyverse Shiny.also free online books stored made publicly available using GitHub. examples include Hadley Wickham’s “R Data Science”, whitepaper currently reading. visit website “R Data Science” desktop browser, notice upper right side page button says, “View source” “Edit page”.Clicking source button take file used create HTML version book. , ’ll able explore repository files used create individual chapter book.Clicking edit button take page instructs , “Fork repository”. means , anyone else, can propose changes book. term “fork” simply means downloading files use edit locally, made proposed changes file, able submit changes authors review. referred “pull requests”, can see listing pull requests users GitHub page repository clicking “Pull Requests” tab.","code":""},{"path":"available-resources.html","id":"wip-development-feedback","chapter":"2 Available Resources","heading":"2.2 WIP: Development Feedback","text":"Goal quickly introduce git GitHub, give overview reader can use pull requests suggest edits packages, projects, papersWe can probably share published version GitHub, bookdown version one can updated new versions. PHUSE likely create final, - formatted version PHUSE template. pdf can exist repo static document.Discussing forking, branching, pull requests probably good, instead context Wickham’s book, perhaps reframe “repository - CSRMLW” ’can contribute codebase repo”","code":""},{"path":"use-cases.html","id":"use-cases","chapter":"3 Use Cases","heading":"3 Use Cases","text":"whitepaper outline framework conducting statistical analyses different programming languages, particularly results across languages may exactly match numerically. purpose paper support statisticians analysts identify reconcile differences numerical results, providing confidence integrity results even another language provides seemingly different results.illustrate framework, provide examples use cases SAS R differences within select families analyses.Specifically, ’re going cover summary statistics, linear models, mixed models, survival models, Cochran-Mantel-Haenszel test. following list simple breakdown paper assist .","code":""},{"path":"use-cases.html","id":"wip-notes","chapter":"3 Use Cases","heading":"3.1 WIP Notes:","text":"1st paragraph: wonder 3rd person instead 1st person.Table: nice table. third column may necessary depending length paper. Page numbers ‘Topic’ level may meaningful (less repetition)Table: Find easier way keep table updated without using MD table formatting","code":""},{"path":"framework.html","id":"framework","chapter":"4 Framework","heading":"4 Framework","text":"paper …","code":""},{"path":"framework.html","id":"types-of-questions-to-ask","chapter":"4 Framework","heading":"4.1 Types of Questions to Ask","text":"Differences documentationDifferences modeling assumptionsDifferences default valuesDifferences available parametersEdge casesCan default call one language replicated another\nyes, numerical equivalence within acceptable level\nyes, numerical equivalence within acceptable levelCan common/historical specification one language replicated another\nyes, numerical equivalence within acceptable level\n, common/historical specification statistically preferred method abandoned?\nyes, numerical equivalence within acceptable levelIf , common/historical specification statistically preferred method abandoned?Can preferred specification one language replicated another?\nyes, numerical equivalence within acceptable level\nyes, numerical equivalence within acceptable levelDifferences available output statisticsDifferences ‘deep’ implementation result decisions developers make implementing particular algorithm\nMay clear documentation level exposed user\nMay clear documentation level exposed user","code":""},{"path":"framework.html","id":"possible-solutions","chapter":"4 Framework","heading":"4.2 Possible Solutions","text":"Select method analysis plan – transparent known alternatives known differencesAre multiple solutions within given language consider?","code":""},{"path":"in-depth.html","id":"in-depth","chapter":"5 In Depth","heading":"5 In Depth","text":"Go class question – describe, explore, illustrate use casesMatrix use cases questions","code":""},{"path":"in-depth.html","id":"topic-1","chapter":"5 In Depth","heading":"5.1 Topic 1","text":"","code":""},{"path":"in-depth.html","id":"topic-2","chapter":"5 In Depth","heading":"5.2 Topic 2","text":"","code":""},{"path":"summary-statistics.html","id":"summary-statistics","chapter":"6 Summary Statistics","heading":"6 Summary Statistics","text":"","code":""},{"path":"linear-models.html","id":"linear-models","chapter":"7 Linear Models","heading":"7 Linear Models","text":"","code":""},{"path":"linear-models.html","id":"topic-1-bv","chapter":"7 Linear Models","heading":"7.1 Topic 1 (BV)","text":"","code":""},{"path":"linear-models.html","id":"getting-started","chapter":"7 Linear Models","heading":"7.1.1 Getting Started","text":"","code":""},{"path":"linear-models.html","id":"sums-of-squares-types","chapter":"7 Linear Models","heading":"7.2 Sums of Squares Types","text":"","code":""},{"path":"linear-models.html","id":"getting-started-1","chapter":"7 Linear Models","heading":"7.2.1 Getting Started","text":"demonstrate various types sums squares, ’ll create data frame called df_disease taken SAS documentation (reference). summary data shown.","code":"## # A tibble: 3 x 3\n##   drug  disease     y\n##   <fct> <fct>   <dbl>\n## 1 1     1          42\n## 2 1     1          44\n## 3 1     1          36##  drug   disease       y        \n##  1:18   1:24    Min.   :-6.00  \n##  2:18   2:24    1st Qu.: 9.00  \n##  3:18   3:24    Median :21.00  \n##  4:18           Mean   :18.88  \n##                 3rd Qu.:28.00  \n##                 Max.   :44.00  \n##                 NA's   :14"},{"path":"linear-models.html","id":"the-model","chapter":"7 Linear Models","heading":"7.2.2 The Model","text":"example, ’re testing significant difference stem_length using ANOVA. R, ’re using lm() run ANOVA, using broom::glance() broom::tidy() view results table format.glance function gives us summary model diagnostic values.tidy function gives summary model results.","code":"\nlm_model <- lm(y ~ drug + disease + drug*disease, df_disease)\nlm_model %>% glance()## # A tibble: 1 x 12\n##   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC\n##       <dbl>         <dbl> <dbl>     <dbl>   <dbl> <dbl>  <dbl> <dbl> <dbl>\n## 1     0.456         0.326  10.5      3.51 0.00130    11  -212.  450.  477.\n## # ... with 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\nlm_model %>% tidy()## # A tibble: 12 x 5\n##    term           estimate std.error statistic      p.value\n##    <chr>             <dbl>     <dbl>     <dbl>        <dbl>\n##  1 (Intercept)      29.3        4.29    6.84   0.0000000160\n##  2 drug2            -1.33       6.36   -0.210  0.835       \n##  3 drug3           -13.0        7.43   -1.75   0.0869      \n##  4 drug4           -15.7        6.36   -2.47   0.0172      \n##  5 disease2         -1.08       6.78   -0.160  0.874       \n##  6 disease3         -8.93       6.36   -1.40   0.167       \n##  7 drug2:disease2    6.58       9.78    0.673  0.504       \n##  8 drug3:disease2  -10.9       10.2    -1.06   0.295       \n##  9 drug4:disease2    0.317      9.30    0.0340 0.973       \n## 10 drug2:disease3   -0.900      9.00   -0.100  0.921       \n## 11 drug3:disease3    1.10      10.2     0.107  0.915       \n## 12 drug4:disease3    9.53       9.20    1.04   0.306"},{"path":"linear-models.html","id":"the-results","chapter":"7 Linear Models","heading":"7.2.3 The Results","text":"’ll see R print individual results level drug disease interaction. can get combined F table R using anova() function model object.extra work, can get Total row match F table output SAS.Comparing output SAS, see following.","code":"\nlm_model %>% \n  anova() %>% \n  tidy() %>% \n  kable()\nlm_model %>%\n  anova() %>%\n  tidy() %>%\n  add_row(term = \"Total\", df = sum(.$df), sumsq = sum(.$sumsq)) %>% \n  kable()proc glm;\n   class drug disease;\n   model y=drug disease drug*disease / ss1 ss2 ss3 ss4;\nrun;"},{"path":"linear-models.html","id":"sums-of-squares-tables","chapter":"7 Linear Models","heading":"7.2.4 Sums of Squares Tables","text":"SAS, easy find tables variouse types sums squares calculations. Unfortunately, easy match output using functions base R. However, rstatix package offers solution produce various sums squares tables. Note appear Type IV SS equivalent R.","code":""},{"path":"linear-models.html","id":"type-i","chapter":"7 Linear Models","heading":"7.2.4.1 Type I","text":"R,SAS,","code":"\ndf_disease %>% \n  rstatix::anova_test(\n    y ~ drug + disease + drug*disease, \n    type = 1, \n    detailed = TRUE) %>% \n  rstatix::get_anova_table() %>% \n  kable()"},{"path":"linear-models.html","id":"type-ii","chapter":"7 Linear Models","heading":"7.2.4.2 Type II","text":"R,SAS,","code":"\ndf_disease %>% \n  rstatix::anova_test(\n    y ~ drug + disease + drug*disease, \n    type = 2, \n    detailed = TRUE) %>% \n  rstatix::get_anova_table() %>% \n  kable()"},{"path":"linear-models.html","id":"type-iii","chapter":"7 Linear Models","heading":"7.2.4.3 Type III","text":"R,SAS,","code":"\ndf_disease %>% \n  rstatix::anova_test(\n    y ~ drug + disease + drug*disease, \n    type = 3, \n    detailed = TRUE) %>% \n  rstatix::get_anova_table() %>% \n  kable()"},{"path":"linear-models.html","id":"type-iv","chapter":"7 Linear Models","heading":"7.2.4.4 Type IV","text":"SAS,R equivalent operation Type IV sums squares calculation SAS.","code":""},{"path":"linear-models.html","id":"wrap-up---sums-of-squares","chapter":"7 Linear Models","heading":"7.2.5 Wrap Up - Sums of Squares","text":"","code":""},{"path":"linear-models.html","id":"contrasts","chapter":"7 Linear Models","heading":"7.3 Contrasts","text":"","code":""},{"path":"linear-models.html","id":"getting-started-2","chapter":"7 Linear Models","heading":"7.3.1 Getting Started","text":"demonstrate contrasts, ’ll create data frame called df_trial. see drug variable three levels, , C E.order work levels contrasts, can use one pre-existing R functions create identity matrix factor variable. contr.treatment definition default one R uses, contr.SAS definition SAS uses default.R also following definitions ready use: contr.sum, contr.poly, contr.helmert.","code":"##  drug        pre             post       sex   \n##  A:10   Min.   : 3.00   Min.   : 0.00   M:15  \n##  C:10   1st Qu.: 7.00   1st Qu.: 2.00   F:15  \n##  E:10   Median :10.50   Median : 7.00         \n##         Mean   :10.73   Mean   : 7.90         \n##         3rd Qu.:13.75   3rd Qu.:12.75         \n##         Max.   :21.00   Max.   :23.00## Rows: 30\n## Columns: 4\n## $ drug <fct> A, A, A, A, A, A, A, A, A, A, C, C, C, C, C, C, C, C, C, C, E, E,~\n## $ pre  <dbl> 11, 8, 5, 14, 19, 6, 10, 6, 11, 3, 6, 6, 7, 8, 18, 8, 19, 8, 5, 1~\n## $ post <dbl> 6, 0, 2, 8, 11, 4, 13, 1, 8, 0, 0, 2, 3, 1, 18, 4, 14, 9, 1, 9, 1~\n## $ sex  <fct> M, F, M, F, M, F, M, F, M, F, M, F, M, F, M, F, M, F, M, F, M, F,~\ncontr.treatment(levels_drug)##   C E\n## A 0 0\n## C 1 0\n## E 0 1\ncontr.SAS(levels_drug)##   A C\n## A 1 0\n## C 0 1\n## E 0 0"},{"path":"linear-models.html","id":"using-contrasts-in-r","chapter":"7 Linear Models","heading":"7.3.2 Using Contrasts in R","text":"many ways work contrasts R, ’re going focus defining contrasts modeling function. example, ’re creating linear model predict post values pre drug values. difference two contrasts argument. one case, ’re using R default, ’re using SAS default.Comparing output two models, see differ drug level used reference baseline.can define custom contrast well. case, comparing E, E baseline group. typical contrasts, values must sum 0, negative numbers represent baseline groups.possible combine contrasts using cbind. Notice contrast definitions don’t require level names assigned, long order levels maintained.","code":"\nmodel_trt <- \n  lm(post ~ pre + drug, data = df_trial,\n     contrasts = list(drug = contr.treatment))\n\nmodel_sas <- \n  lm(post ~ pre + drug, data = df_trial,\n     contrasts = list(drug = contr.SAS))\ntidy(model_trt)## # A tibble: 4 x 5\n##   term        estimate std.error statistic    p.value\n##   <chr>          <dbl>     <dbl>     <dbl>      <dbl>\n## 1 (Intercept)   -3.88      1.99    -1.95   0.0616    \n## 2 pre            0.987     0.164    6.00   0.00000245\n## 3 drug2          0.109     1.80     0.0607 0.952     \n## 4 drug3          3.45      1.89     1.83   0.0793\ntidy(model_sas)## # A tibble: 4 x 5\n##   term        estimate std.error statistic    p.value\n##   <chr>          <dbl>     <dbl>     <dbl>      <dbl>\n## 1 (Intercept)   -0.435     2.47     -0.176 0.862     \n## 2 pre            0.987     0.164     6.00  0.00000245\n## 3 drug1         -3.45      1.89     -1.83  0.0793    \n## 4 drug2         -3.34      1.85     -1.80  0.0835\nlm(post ~ pre + drug, data = df_trial,\n   constrasts = list(drug = c(\"A\" = 1, \"C\" = \"0\", \"E\" = -1)))\ncontrast_1 <- c(1,  0, -1)\ncontrast_2 <- c(1, -2,  1)\n\ncontrast_c <- cbind(contrast_1, contrast_2)\n\nlm(post ~ pre + drug, data = df_trial,\n   contrasts = contrast_c)"},{"path":"linear-models.html","id":"easy-contrasts-in-r-with-emmeans","chapter":"7 Linear Models","heading":"7.3.3 Easy Contrasts in R with emmeans","text":"emmeans package makes working contrasts much easier. fact, method recommend trying match contrast output SAS R.begin defining models.convert models emmeans models. emmeans function can specify variables want display estimated marginal means ., can define common contrasts contrast function.can also control reference group, reverse contrast order using arguments contrast function.Custom contrasts can defined well.","code":"\nmodel_lm <-  lm(post ~ pre + drug + sex, data = df_trial)\nmodel_av <- aov(post ~ pre + drug + sex, data = df_trial)\nmodel_gm <- glm(post ~ pre + drug + sex, data = df_trial)\nmodel_lm %>% emmeans(specs = \"drug\")\nmodel_av %>% emmeans(specs = \"drug\", by = \"sex\")\nmodel_gm %>% emmeans(specs = ~ drug | sex)\n# All Pairwise Comparisons\nmodel_lm %>% \n  emmeans(\"drug\") %>% \n  contrast(method = \"pairwise\")     \n\n# Treatment v Control Comparison\nmodel_gm %>% \n  emmeans(\"drug\") %>% \n  contrast(method = \"trt.vs.ctrl\")  \nmodel_lm %>% \n  emmeans(\"drug\") %>% \n  contrast(method = \"trt.vs.ctrl\", ref = 2)     \n\nmodel_lm %>% \n  emmeans(\"drug\") %>% \n  contrast(method = \"trt.vs.ctrl\", rev = T)     \nmodel_lm %>% \n  emmeans(\"drug\") %>% \n  contrast(method = list(\n    \"A v E\"  = c(\"A\" = 1, \"C\" = 0, \"E\" = -1),\n    \"AE v C\" = c(1, -2, 1),\n    \"A\"      = c(1, 0, 0)\n  ))"},{"path":"linear-models.html","id":"matching-contrasts-r-and-sas","chapter":"7 Linear Models","heading":"7.3.4 Matching Contrasts: R and SAS","text":"recommended use emmeans package attempting match contrasts R SAS. SAS, contrasts must manually defined, whereas R, many ways use pre-existing contrast definitions. emmeans package makes simplifies process, provides syntax similar syntax SAS.define contrast SAS.define contrast R, using emmeans package.Note, however, cases scale parameter estimates SAS R , though test statistics p-values identical. cases, can adjust SAS code include divisor. far can tell, difference occurs using predefined Base R contrast methods like contr.helmert.","code":"# In SAS\nproc glm data=work.mycsv;\n   class drug;\n   model post = drug pre / solution;\n   estimate 'C vs A'  drug -1  1 0;\n   estimate 'E vs CA' drug -1 -1 2;\nrun;\nlm(formula = post ~ pre + drug, data = df_trial) %>% \n  emmeans(\"drug\") %>% \n  contrast(method = list(\n    \"C vs A\"  = c(-1,  1, 0),\n    \"E vs CA\" = c(-1, -1, 2)\n  ))proc glm data=work.mycsv;\n   class drug;\n   model post = drug pre / solution;\n   estimate 'C vs A'  drug -1  1 0 / divisor = 2;\n   estimate 'E vs CA' drug -1 -1 2 / divisor = 6;\nrun;"},{"path":"linear-models.html","id":"wrap-up---contrasts","chapter":"7 Linear Models","heading":"7.3.5 Wrap Up - Contrasts","text":"","code":""},{"path":"mixed-models.html","id":"mixed-models","chapter":"8 Mixed Models","heading":"8 Mixed Models","text":"","code":""},{"path":"mixed-models.html","id":"repeated-measures","chapter":"8 Mixed Models","heading":"8.1 Repeated Measures","text":"","code":""},{"path":"mixed-models.html","id":"introduction-1","chapter":"8 Mixed Models","heading":"8.1.1 Introduction","text":"document focuses comparison results generated using Mixed Model Repeated Measures (MMRM) SAS R. Data comparison lab ADaM dataset adlbh.xpt Phuse Pilot Study. Results generated lab parameter time point dataset using three different covariance structures, .e. unstructured, compound symmetry autoregressive first order (AR(1)).","code":""},{"path":"mixed-models.html","id":"fitting-the-mmrm-in-sas","chapter":"8 Mixed Models","heading":"8.1.1.1 Fitting the MMRM in SAS","text":"SAS following code used (assessments avisitn=0 also removed response variable):macro variable covar UN, CS AR(1). results stored .csv files post-processed R compared results R.","code":"proc mixed data=adlbh;\nwhere base ne . and avisitn not in (., 99);\nclass usubjid trtpn(ref=\"0\") avisitn;\nby paramcd param;\nmodel chg=base trtpn avisitn  trtpn*avisitn / solution cl alpha=0.05 ddfm=KR;\nrepeated avisitn/subject=usubjid type=&covar;\nlsmeans trtpn * avisitn / diff cl slice=avisitn;\nlsmeans trtpn / diff cl;\nrun;"},{"path":"mixed-models.html","id":"fitting-the-mmrm-in-r","chapter":"8 Mixed Models","heading":"8.1.2 Fitting the MMRM in R","text":"","code":""},{"path":"mixed-models.html","id":"using-the-nlmegls-function","chapter":"8 Mixed Models","heading":"8.1.2.1 Using the nlme::gls function","text":"code implements MMRM fit R nlme::gls function.can swap corSymm corCompSymm give compound symmetry structure corCAR1 autoregressive first order (AR(1)).","code":"\ngls(model = CHG ~ TRTP + AVISITN + TRTP:AVISITN + AVISITN + BASE,\n    data = data,\n    correlation = corSymm(form = ~1|SUBJID),\n    weights = varIdent(form = ~1|AVISITN),\n    control = glsControl(opt = \"optim\"),\n    method = \"REML\",\n    na.action = \"na.omit\")"},{"path":"mixed-models.html","id":"using-the-lme4lmer-function","chapter":"8 Mixed Models","heading":"8.1.2.2 Using the lme4::lmer function","text":"alternative way fit MMRM unstructured covariance matrices use lme4::lmer function described Daniel Sabanes Bove R Pharma talk 2020 see . relevance fit apparent consider availability Kenward-Roger’s degrees freedom MMRM R, time writing, yet available nlme::gls function via pbkrtest package (see ).","code":"\nlmer(CHG ~ TRTA * VISIT + VISIT + BASE + (0 + VISIT|SUBJID),\n     data = data,\n     control = lmerControl(check.nobs.vs.nRE = \"ignore\"),\n     na.action = na.omit)"},{"path":"mixed-models.html","id":"extracting-effect-estimates-using-emmeans","chapter":"8 Mixed Models","heading":"8.1.2.3 Extracting effect estimates using emmeans","text":"order extract relevant marginal means (LSmeans) contrasts can use emmeans package. start constructing ref_grid used make explicit just predictions generated across levels TRTP AVISITN. emmeans function permits various marginal means extracted depending formula provided following pairs() function call derives relevant contrasts. Note control can obtained calling contrast() function.","code":"\nmod_grid <- ref_grid(model, data = data, mode = \"df.error\")\nmod_emm <- emmeans(mod_grid, ~TRTP * AVISITN, mode = \"df.error\") \npairs(mod_emm) "},{"path":"mixed-models.html","id":"comparison-between-sas-and-r","chapter":"8 Mixed Models","heading":"8.1.3 Comparison between SAS and R","text":"results available SAS R model fits, turn attention generating visual comparisons results. Note adopt Bland-Altman type plot plots difference y-axis average x-axis. offers way inspect bias relationships size effect associated bias.extracted LS-meansand corresponding SEsFor derived contrastsand corresponding 95%CI widths","code":""},{"path":"mixed-models.html","id":"analysis-of-sas-and-r-comparison","chapter":"8 Mixed Models","heading":"8.1.4 Analysis of SAS and R Comparison","text":"Using SAS PROC MIXED R functions gls, lmer, mod_grid, mod_emm, results broadly aligned. Results exact can attributed many factors rounding precision, data handling, many internal processing nuances. However, Bland-Altman type plots showed small randomly distributed differences across broad range parameters input data. Apart small subset parameters, trends observed suggested systemic differences languages. analyses based single set data research must done. However, based comparing R documentation SAS documentation, well results displayed paper, evident R SAS methods cover produce similarly valid results options tested.","code":""},{"path":"mixed-models.html","id":"future-work","chapter":"8 Mixed Models","heading":"8.1.5 Future work","text":"Run SAS code also removing assessments avisitn=0 response variable, using trtp (trtpn) avisit (avisitn)Investigating differencesImplement lmer equivalent MMRM compound symmetryComparisons models, .e. random, random repeated, repeated","code":""},{"path":"survival-models.html","id":"survival-models","chapter":"9 Survival Models","heading":"9 Survival Models","text":"","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"cochran-mantel-haenszel-test","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10 Cochran-Mantel-Haenszel Test","text":"CMH procedure tests conditional independence partial contingency tables 2 x 2 x K design. However, can generalized tables X x Y x K dimensions.","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"naming-convention","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.1 Naming Convention","text":"remainder document, adopt following naming convention referring variables contingency table:X = exposureY = responseK = control","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"scale","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.2 Scale","text":"scale exposure (X) response (Y) variables dictate test statistic computed contingency table. test statistic evaluated different degrees freedom (df):General association statistic (X Y nominal) results (X-1) * (Y-1) dfsRow mean scores statistic (X nominal Y ordinal) results X-1 dfsNonzero correlation statistic (X Y ordinal) results 1 df","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"testing-strategy","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.3 Testing Strategy","text":"","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"data","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.3.1 Data","text":"begin investigating differences SAS R implementations CMH test, decided use CDISC Pilot data set, publicly available PHUSE Test Data Factory repository. applied basic filtering conditions upfront (see ) data set served basis examples follow.","code":"\n# Download CDISC Pilot Dataset\n# Perform filtering\nlibrary(haven)\nread_xpt(\"https://github.com/phuse-org/TestDataFactory/raw/main/Updated/TDF_ADaM/adcibc.xpt\") %>% \n  filter(EFFFL == 'Y' & ITTFL == 'Y', AVISITN == 8 & ANL01FL=='Y') "},{"path":"cochran-mantel-haenszel-test.html","id":"schemes","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.3.2 Schemes","text":"order follow systematic approach testing, cover variations CMH test, considered traditional 2 x 2 x K design well scenarios generalized CMH test employed (e.g. 5 x 3 x 3).present 5 archetype test scenarios illustrate diverging results, possibly related sparse data possibly considered edge cases.","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"implementation","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.4 Implementation","text":"","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"cmh-in-sas","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.4.1 CMH in SAS","text":"cmh test calculated SAS using PROC FREQ procedure. default, outputs chi square statistic, degrees freedom p-value three alternative hypothesis: general association, row means differ, nonzero correlation. statistical analyst statistician know result appropriate analysis.design contingency table 2 x 2 x K (.e, X == 2 levels, Y == 2 levels, K >= 2 levels), Mantel-Haenszel Common Odds Ratio (odds ratio estimate, 95% CI, P-value) Breslow-Day Test Homogeneity Odds Ratios (chi-square statistic, degrees freedom, P-value) also output.syntax conduct CMH analysis SAS:","code":"Proc freq data = filtered_data; \ntables K * X * Y / cmh; \n* the order of K, X, and Y appearing on the line is important!;\nrun; "},{"path":"cochran-mantel-haenszel-test.html","id":"in-r","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.4.2 In R","text":"find R package delivers measures SAS . Therefore, tried multiple packages:","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"mantelhaen.test","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.4.2.1 mantelhaen.test()","text":"included base installation R, part stats package. Requires inputting data table vectors.","code":"\nmantelhaen.test(x = data$x, y = data$y, z = data$k)"},{"path":"cochran-mantel-haenszel-test.html","id":"cmhtest","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.4.2.2 CMHtest()","text":"vcdExtra package provides results generalized CMH test, three model outputs Chi-square value respective p-values. Flexible data input methods available: table formula (aggregated level data data frame).","code":"\nlibrary(vcdExtra)\nCMHtest(Freq ~ X + Y | K , data=data, overall=TRUE) "},{"path":"cochran-mantel-haenszel-test.html","id":"forked-version---solution-for-sparse-data","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.4.2.2.1 Forked Version - Solution for sparse data","text":"tackle issue sparse data recommended use solve() replaced MASS::ginv. implemented forked version vcdExtra can installed :However, also forked version vcdExtra package works certain level sparsity. case data, still works data stratified pooled Site ID (SITEGR1 - 11 unique values) whereas using unpooled Site ID (SITEID - 17 unique values) also throws error.","code":"\ndevtools::install_github(\"mstackhouse/vcdExtra\")"},{"path":"cochran-mantel-haenszel-test.html","id":"inconsistent-results","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.4.2.2.2 Inconsistent Results","text":"Exploring vcdExtra package detail realized seems bug implementation like highlight .Using independent data example (3x2x2), first ran CMH test SAS obtained following:specify analysis R way, get following results:default, 3 tests (4th) output. results seem match.specify analysis using explicit type argument, get following results:’ve essentially asked everything (.e. default), albeit explicitly, results match. degrees freedom seem mismatched results wrong p-values (assume SAS gold standard)Similarly, specify like certain tests returned, results seem dependent order specification:Impact: event 2x2xK design, 3 test statistics, degrees freedom p-values . Therefore, specifying 2x2xK analysis ways results correct “answer”, though technically mixed .chose 3x2x2, can clearly things mixed .planning submit issue vcdExtra github author’s review.","code":"\n# Cochran-Mantel-Haenszel Statistics (Based on Table Scores)\n# Statistic    Alternative Hypothesis    DF       Value      Prob\n# ---------------------------------------------------------------\n#   1        Nonzero Correlation        1      6.4586    0.0110\n#   2        Row Mean Scores Differ     2     26.0278    <.0001\n#   3        General Association        2     26.0278    <.0001\nCMHtest(Freq~x+y|k, data=test_eg, overall=TRUE, details=TRUE)$ALL$table##         Chisq    Df Prob        \n## cor     6.458575 1  0.01104181  \n## rmeans  26.02779 2  2.229135e-06\n## cmeans  6.458575 1  0.01104181  \n## general 26.02779 2  2.229135e-06\nCMHtest(Freq~x+y|k, data=test_eg, overall=TRUE, details=TRUE, type = \"ALL\")$ALL$table##         Chisq    Df Prob        \n## general 26.02779 1  3.365374e-07\n## rmeans  26.02779 2  2.229135e-06\n## cmeans  6.458575 1  0.01104181  \n## cor     6.458575 2  0.03958569\n# Order: cor, general, rmeans\nCMHtest(Freq~x+y|k, data=test_eg, overall=TRUE, details=TRUE, types=c(\"cor\",\"general\",\"rmeans\"))$ALL$table##         Chisq    Df Prob        \n## cor     6.458575 1  0.01104181  \n## general 26.02779 2  2.229135e-06\n## rmeans  26.02779 2  2.229135e-06\n# Order: rmeans, general, cor\nCMHtest(Freq~x+y|k, data=test_eg, overall=TRUE, details=TRUE, types=c(\"rmeans\",\"general\",\"cor\"))$ALL$table##         Chisq    Df Prob        \n## rmeans  26.02779 1  3.365374e-07\n## general 26.02779 2  2.229135e-06\n## cor     6.458575 2  0.03958569"},{"path":"cochran-mantel-haenszel-test.html","id":"epi-display-package","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.4.2.3 Epi Display package","text":"get M-H common odds ratio homogeneity test, epiDisplay package can used.","code":"\nlibrary(epiDisplay) \nmhor(x,y,k, graph = FALSE)"},{"path":"cochran-mantel-haenszel-test.html","id":"results","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.5 Results","text":"results can seen:","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"cmh-statistics","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.5.1 CMH Statistics","text":"can seen, two schemata R provide results:Reason NaN schema 3: Stratum k = AMERICAN INDIAN ALASKA NATIVE can compared values one treatment one gender.Reason Error 4:\nlarge sparse table (many strata) CMHTest occasionally throw error solve.default(AVA) singularity","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"odds-ratio","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.5.2 Odds Ratio","text":"applicable 2x2xK designs.","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"homogenity-test","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.5.3 Homogenity Test","text":"applicable 2x2xK designs.","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"summary-and-recommendation","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.6 Summary and Recommendation","text":"explored available R packages calculate CMH statistics, using R can recommended analysis design equivalent 2 x 2 x K. , base mantelhaen.test() function well vcdExtra package show reliable results equal output SAS function. true common odds ratio even though marked difference decimals.generalized version cmh test R package can recommended far. SAS R outputs differ substantially (possibly due underlying subroutines functions) vcdExtra package seems deliver inconsistent results outside 2 x 2 x K design.","code":""},{"path":"cochran-mantel-haenszel-test.html","id":"references","chapter":"10 Cochran-Mantel-Haenszel Test","heading":"10.7 References","text":"Accessible SummaryAn Introduction Categorical Data Analysis 2nd Edition (Agresti)SAS Documentation (Specification)SAS Documentation (Theoretical Basis + Formulas)Original Paper 1Original Paper 2","code":""},{"path":"bookdown-template-title-of-chapter.html","id":"bookdown-template-title-of-chapter","chapter":"11 Bookdown Template: Title of Chapter","heading":"11 Bookdown Template: Title of Chapter","text":"Replace text introduction chapter.Ensure first line document starts single # defines chapter title","code":""},{"path":"bookdown-template-title-of-chapter.html","id":"title-of-sub-section","chapter":"11 Bookdown Template: Title of Chapter","heading":"11.1 Title of Sub-Section","text":"Replace text discussion sub-section topic.Insert R code chunks necessaryRefer RStudio Help Menu > Markdown Quick Reference formatting guidanceSee RMarkdown information rmarkdown worksSee Bookdown information bookdown worksThe GitHub Page examples individual .Rmd files formatted","code":"\nstr(mtcars)## 'data.frame':    32 obs. of  11 variables:\n##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...\n##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...\n##  $ disp: num  160 160 108 258 360 ...\n##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...\n##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...\n##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...\n##  $ qsec: num  16.5 17 18.6 19.4 17 ...\n##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...\n##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...\n##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...\n##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...# Markdown chunks will be treated as raw markdown syntax, and will not be converted to HTML"},{"path":"bookdown-template-title-of-chapter.html","id":"title-of-sub-section-1","chapter":"11 Bookdown Template: Title of Chapter","heading":"11.2 Title of Sub-Section","text":"Replace text discussion sub-section topic.","code":""},{"path":"bookdown-template-title-of-chapter.html","id":"title-of-sub-section-2","chapter":"11 Bookdown Template: Title of Chapter","heading":"11.3 Title of Sub-Section","text":"Replace text discussion sub-section topic.","code":""}]
